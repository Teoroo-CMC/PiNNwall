# PiNNwall

This project is about using PiNN to predict the charge response kernal (CRK) and use it in the Metalwalls MD simulation. PiNNwall is based on the work presented in this paper (bibtex here for citation). Here is a link to the Jupyter notebook Tutorial.

## Preparation

PiNNwall predicts the Hessian Matrix for Metalwalls (link) using machine learning (ML)-models trained using PiNN (link). In order to run PiNNwall, one needs to have PiNN installed first.

Before prediction, one needs to have constructed the input files of Metalwalls, namely the data.inpt and runtime.inpt, which you will use to run the Metalwalls simulations.

Then, clone this repo to get the scripts and the ML-models that will be used in predicting the CRK.

After executing PiNNwall, it will generate a hessian_matrix.inpt to be used by Metalwalls which contains the machine learned CRK. PiNNwall will also update the hardness, and the cutoff parameters in the runtime.inpt to ensure that consistency between PiNN and Metalwalls necessary when using Metalwalls to run the MD simulations.

Note, to achieve performance consistent with the PiNNwall paper, a modified version of Metalwalls must be used. This will be made available upon request.

## Synopsis

```python
python pinnwall [-p <MODEL_DIR>] [-i <WORKING_DIR>] [-m [<methodename>]] [-o <filename>]
```

Options:

`-p  <MODEL_DIR> (./trained_models)`
path to the trained pinn model

`-i <WORKING_DIR> (./)`
path to the input files of MW

`-m [<methodename>] (eem)`
List of model used to compute the CRK to construct the Hessian Matrix employed by Metalwalls

`-o <filename> (pinnwall.out)`
log of pinnwall, default to inputs_dir

## Simulating with Metalwalls

To start a Metalwalls simulation, ensure that you have placed the hessian_maxtrix.inpt file generated by PiNNwall in the run directory, along with the modified runtime.inpt file. Also place the data.inpt file you used when executing PiNNwall in the same run directory. Then, execute Metalwalls as usual.

## Suitable systems

The ML-models provided with PiNNwall were trained using the QM7b dataset. This means that presently, PiNNwall is only able to predict sensible Hessian matrices for electrodes containing C, H, N, O, S, and Cl. You are encouraged to train more models using the polarizability models included in the PiNN package. For this the usage of the PiNet2 network is recommended. These can then easily be integrated into PiNNwall by placing them into the `trained_models` folder.

We recommend that you use the EEM models for carbonaceous system as this seems to yield the most physical performance when comparing a carbon electrode to a perfect metal system. More in-depth information on the performance of all model types can be found in the PiNN papers [^1].

[^1]: This is the footnote.
